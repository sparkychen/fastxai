env {
  #execution.parallelism = 10
  parallelism = 10
  job.mode = "BATCH"

  table.exec.state.ttl = "2h"
  execution.checkpointing.interval = 0

  # 根据数据量和内存调整
  taskmanager.memory.process.size = "4096m"
  taskmanager.numberOfTaskSlots = "4"
  
  # 网络缓冲区优化
  taskmanager.memory.network.fraction = "0.1"
  taskmanager.memory.network.min = "64mb"
  taskmanager.memory.network.max = "1gb"
}

source {
  Jdbc {
    driver = "com.mysql.cj.jdbc.Driver"
    url = "jdbc:mysql://192.168.30.122:3306/xypt"
    username = "shxypt"
    password = "shxypt@0925"
    query = "SELECT * FROM sxsj_scj_corp_info_new"

    # 源数据库优化参数
    connection.max-retry-timeout = "300s"
    connection.pool.size = 5
    connection.timeout = "30s"
    socket.timeout = "300s"
    
    partition_column = "id"
    partition_num = 10  # defalt is job parallelism
    split.size = 10000 default：8096
    #fetch_size = 2000
    query-timeout = "120s"
  }
}

sink {
  jdbc {
    url = "jdbc:mysql://192.168.30.170:3306/economic_security_platform_ods?useUnicode=true&characterEncoding=UTF-8&rewriteBatchedStatements=true"
    driver = "com.mysql.cj.jdbc.Driver"
    username = "data_transfer"
    password = "xxzx@20251210"
    
    primary_keys = ["id"]
    batch_size = 10000
    enable_upsert = false
    is_exactly_once = false

    write-mode = "INSERT"
    

    generate_sink_sql = true
    database = "economic_security_platform_ods"
    table = "sxsj_scj_corp_info_new"

    max_retries = 3
    is_exactly_once = false    

    # 超时参数优化
    connection.max-retry-timeout = "600s"
    connection.timeout = "30s"
    socket.timeout = "600s"
    query-timeout = "300s"
    
    # 连接池优化
    connection-pool.max-size = 20
    connection-pool.min-size = 5
    connection-pool.idle-timeout = "30m"
    connection-pool.max-lifetime = "60m"
    connection-pool.connection-timeout = "30s"
    connection-pool.validation-timeout = "5s"
  }
}
